{"version":3,"file":"time.js","sources":["../../../src/components/time/time.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { Tooltip } from '../../tooltip'\nimport { TimeUtils, TimeConfig } from './time-utils'\n\nimport './time.less'\n\nconst DELAY = 60000\n\ntype Props = {\n    /** UNIX timestamp of the time to display. */\n    time?: number\n    /** Configuration for localization. */\n    config?: TimeConfig\n    /** Additional css class applied to the time element. */\n    className?: string\n    tooltipOnHover?: boolean\n    /** Refresh the component every DELAY seconds. */\n    refresh?: boolean\n    /** If you don't want to use the default time format on the tooltip use this prop to supply a custom text */\n    tooltip?: React.ReactNode\n    /** When hovering over time it expands to short absolute version. */\n    expandOnHover?: boolean\n    /** When hovering over time it expands to the full absolute version. */\n    expandFullyOnHover?: boolean\n}\n\ntype State = {\n    hovered: boolean\n    mouseX?: number\n    mouseY?: number\n}\n\nclass Time extends React.Component<Props, State> {\n    public static displayName: string\n    public static defaultProps: Props\n\n    constructor(props: Props) {\n        super(props)\n        this.refreshInterval = undefined\n\n        this.state = {\n            hovered: false,\n            mouseX: undefined,\n            mouseY: undefined,\n        }\n    }\n\n    componentDidMount() {\n        if (this.props.refresh) {\n            this._refresh()\n        }\n    }\n\n    componentDidUpdate(prevProps: Props) {\n        if (!prevProps.refresh && this.props.refresh) {\n            this._refresh()\n        }\n\n        if (prevProps.refresh && !this.props.refresh) {\n            if (this.refreshInterval) {\n                clearTimeout(this.refreshInterval)\n            }\n        }\n    }\n\n    componentWillUnmount() {\n        if (this.refreshInterval) {\n            clearTimeout(this.refreshInterval)\n        }\n    }\n\n    refreshInterval?: ReturnType<typeof setTimeout>\n\n    _setHovered(hovered: boolean, event: React.MouseEvent) {\n        const { mouseX, mouseY } = this.state\n        const { clientX, clientY } = event\n        if (clientX !== mouseX || clientY !== mouseY) {\n            // mouse has moved\n            this.setState(() => ({\n                hovered,\n                mouseX: clientX,\n                mouseY: clientY,\n            }))\n        }\n    }\n\n    _renderTime(config: Props['config']) {\n        if (!this.props.time) {\n            return\n        }\n        if (this.state.hovered) {\n            if (this.props.expandFullyOnHover && !this.props.tooltipOnHover) {\n                return TimeUtils.formatTimeLong(this.props.time, config)\n            }\n            if (this.props.expandOnHover && !this.props.tooltipOnHover) {\n                return TimeUtils.formatTime(this.props.time, config)\n            }\n        }\n        return TimeUtils.timeAgo(this.props.time, config)\n    }\n\n    _refresh() {\n        this.refreshInterval = setInterval(() => {\n            this.forceUpdate()\n        }, DELAY)\n    }\n\n    render() {\n        let className = 'reactist_time'\n        if (this.props.className) {\n            className = this.props.className\n        }\n\n        const timeComponent = this._renderTime(this.props.config)\n\n        return (\n            <time\n                className={className}\n                onMouseEnter={(event) => this._setHovered(true, event)}\n                onMouseLeave={(event) => this._setHovered(false, event)}\n            >\n                {this.props.tooltipOnHover ? (\n                    <Tooltip\n                        content={\n                            this.props.tooltip ||\n                            (this.props.time &&\n                                TimeUtils.formatTimeLong(this.props.time, this.props.config))\n                        }\n                    >\n                        <span>{timeComponent}</span>\n                    </Tooltip>\n                ) : (\n                    timeComponent\n                )}\n            </time>\n        )\n    }\n}\nTime.displayName = 'Time'\n\nTime.defaultProps = {\n    expandOnHover: false,\n    expandFullyOnHover: false,\n    tooltipOnHover: false,\n    refresh: true,\n    config: {\n        locale: 'en',\n        daysSuffix: 'd',\n        hoursSuffix: 'h',\n        minutesSuffix: 'm',\n        momentsAgo: 'moments ago',\n    },\n}\n\nexport { Time }\n"],"names":["DELAY","Time","React","Component","constructor","props","refreshInterval","undefined","state","hovered","mouseX","mouseY","componentDidMount","refresh","_refresh","componentDidUpdate","prevProps","clearTimeout","componentWillUnmount","_setHovered","event","clientX","clientY","setState","_renderTime","config","time","expandFullyOnHover","tooltipOnHover","TimeUtils","formatTimeLong","expandOnHover","formatTime","timeAgo","setInterval","forceUpdate","render","className","timeComponent","createElement","onMouseEnter","onMouseLeave","Tooltip","content","tooltip","displayName","defaultProps","locale","daysSuffix","hoursSuffix","minutesSuffix","momentsAgo"],"mappings":"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"}