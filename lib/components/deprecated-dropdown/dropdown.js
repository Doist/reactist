"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("../../_virtual/_rollupPluginBabelHelpers.js"),e=require("react"),o=require("react-dom"),i=require("classnames"),s=require("../deprecated-button/deprecated-button.js");function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}function n(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(o){if("default"!==o){var i=Object.getOwnPropertyDescriptor(t,o);Object.defineProperty(e,o,i.get?i:{enumerable:!0,get:function(){return t[o]}})}})),e.default=t,e}var d=n(e),l=r(o),a=r(i);const c=["children","onClick","tooltip","className"];class p extends d.Component{constructor(t,e){super(t,e),this._timeout=void 0,this._handleClickOutside=t=>{const e=l.default.findDOMNode(this);e&&!e.contains(t.target)?this._toggleShowBody():this.props.allowBodyInteractions||(this._timeout=setTimeout(()=>{this.state.showBody&&this._toggleShowBody()},100))},this._toggleShowBody=()=>{this.state.showBody?(this.props.onHideBody&&this.props.onHideBody(),document.removeEventListener("click",this._handleClickOutside,!0)):(this.props.onShowBody&&this.props.onShowBody(),document.addEventListener("click",this._handleClickOutside,!0)),this.setState({showBody:!this.state.showBody})},this._setPosition=t=>{if(t){const e=document.getElementById(this.props.scrolling_parent?this.props.scrolling_parent:"");if(e){const o=l.default.findDOMNode(this);if(!o)return;const i=l.default.findDOMNode(this).offsetTop,s=o.querySelector(".trigger");if(!s)return;const r=e.clientHeight+e.scrollTop-i-s.clientHeight<t.clientHeight;r!==this.state.top&&this.setState({top:r})}}},this.state={showBody:!1,top:t.top||!1},this._timeout=void 0}componentWillUnmount(){document.removeEventListener("click",this._handleClickOutside,!0),this._timeout&&clearTimeout(this._timeout)}_getTriggerComponent(){var t;const e=null==(t=this.props.children)?void 0:t[0];return e?d.cloneElement(e,{onClick:this._toggleShowBody}):void 0}_getBodyComponent(){if(!this.state.showBody)return null;const{top:t}=this.state,{right:e=!1,children:o}=this.props,i={top:t,right:e,setPosition:this._setPosition},s=a.default({body_wrapper:!0,with_arrow:!0,top:t,bottom:!t}),r=null==o?void 0:o[1],n="function"==typeof r?r(i):r?d.cloneElement(r,i):void 0;return d.createElement("div",{className:s,style:{position:"relative"}},n)}render(){const t=a.default("reactist_dropdown",this.props.className),{top:e}=this.state;return d.createElement("div",{style:{display:"inline-block"},className:t,"data-testid":"reactist-dropdown-box"},e&&this._getBodyComponent(),this._getTriggerComponent(),!e&&this._getBodyComponent())}}p.displayName=void 0,p.displayName="Dropdown.Box";const u=d.forwardRef((function(e,o){let{children:i,onClick:r,tooltip:n,className:l}=e,p=t.objectWithoutProperties(e,c);return d.createElement(s.Button,t.objectSpread2(t.objectSpread2({},p),{},{className:a.default("trigger",l),onClick:function(t){t.preventDefault(),t.stopPropagation(),r&&r(t)},tooltip:n,ref:o}),i)}));function h({top:t,right:e,children:o,setPosition:i}){const s={position:"absolute",right:0,top:0};return t&&(s.top="auto",s.bottom=0),e&&(s.right="auto",s.left=0),d.createElement("div",{ref:i,style:s,className:"body",id:"reactist-dropdown-body","data-testid":"reactist-dropdown-body"},o)}u.displayName="Dropdown.Trigger",h.displayName="Dropdown.Body",exports.Dropdown={Box:p,Trigger:u,Body:h};
//# sourceMappingURL=dropdown.js.map
